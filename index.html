<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom FoxyCart Sidecart</title>
    
    <!-- FoxyCart CSS Files (Required) -->
    {% for css_file_href in config.css_files %}
        <link href="{{ css_file_href }}" rel="stylesheet" media="all">
    {% endfor %}
    
    <!-- Custom Font -->
    <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;1,400&display=swap" rel="stylesheet">
    
    <!-- Custom Styles -->
    <style>
        /* Override FoxyCart styles with your custom design */
        #fc {
            font-family: 'EB Garamond', serif !important;
            background: #DBD8D1 !important;
            padding: 0px 15px !important;
        }

        /* Navigation Bar */
        #fc .fc-sidecart-only-fixed {
            background: transparent !important;
            padding: 20px 0px 10px !important;
            display: flex !important;
            justify-content: space-between !important;
            align-items: center !important;
        }

        #fc .fc-fixed-button-left,
        #fc .fc-fixed-button-right {
            display: flex !important;
            align-items: center !important;
            gap: 10px !important;
            background: none !important;
            border: none !important;
            font-family: 'EB Garamond', serif !important;
            font-style: italic !important;
            font-weight: 400 !important;
            font-size: 20px !important;
            color: #1E2321 !important;
            text-decoration: none !important;
        }

        #fc .fc-fixed-button-left .fc-svg-icon {
            transform: matrix(-1, 0, 0, 1, 0, 0) !important;
        }

        /* Cart Header */
        #fc .fc-cart__title__header {
            font-family: 'EB Garamond', serif !important;
            font-style: italic !important;
            font-weight: 400 !important;
            font-size: 38px !important;
            color: #1E2321 !important;
            margin-bottom: 10px !important;
        }

        #fc .fc-order-quantity {
            font-family: 'EB Garamond', serif !important;
            font-size: 20px !important;
            color: #1E2321 !important;
            margin-bottom: 30px !important;
        }

        /* Empty Cart */
        #fc .fc-cart__empty {
            background: #F6F5F4 !important;
            border-radius: 20px !important;
            padding: 15px 10px !important;
            text-align: center !important;
            margin-bottom: 30px !important;
        }

        #fc .fc-cart__empty p {
            font-family: 'EB Garamond', serif !important;
            font-size: 24px !important;
            color: #1E2321 !important;
            margin: 0 !important;
        }

        /* Cart Items */
        #fc .fc-cart__item {
            background: #F6F5F4 !important;
            border-radius: 10px !important;
            padding: 20px 10px !important;
            position: relative !important;
            margin-bottom: 10px !important;
            display: flex !important;
            flex-direction: column !important;
            gap: 15px !important;
        }

        /* Remove Button */
        #fc .fc-cart__item__remove {
            position: absolute !important;
            top: 5px !important;
            right: 10px !important;
            width: 10px !important;
            height: 10px !important;
            border: 1px solid #1E2321 !important;
            background: transparent !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            font-size: 8px !important;
            color: #1E2321 !important;
            text-decoration: none !important;
        }

        /* Product Info Layout */
        #fc .fc-cart__item__details-and-image {
            display: flex !important;
            gap: 10px !important;
            align-items: flex-start !important;
        }

        #fc .fc-cart__item__image {
            width: 80px !important;
            height: 80px !important;
            border-radius: 10px !important;
            flex-shrink: 0 !important;
        }

        #fc .fc-cart__item__image img {
            width: 100% !important;
            height: 100% !important;
            object-fit: cover !important;
            border-radius: 10px !important;
        }

        #fc .fc-cart__item__name {
            font-family: 'EB Garamond', serif !important;
            font-weight: 500 !important;
            font-size: 18px !important;
            color: #1E2321 !important;
            margin: 0 0 10px 0 !important;
        }

        /* Hide unwanted elements */
        #fc .fc-cart__item__option {
            display: none !important;
        }

        /* Quantity and Price Controls */
        #fc .fc-cart__item__totals {
            display: flex !important;
            justify-content: space-between !important;
            align-items: flex-end !important;
            margin-top: 10px !important;
        }

        #fc .fc-cart__item__quantity__input {
            width: 29px !important;
            height: 22px !important;
            border: 1px solid rgba(30, 35, 33, 0.5) !important;
            border-radius: 5px !important;
            text-align: center !important;
            font-family: 'EB Garamond', serif !important;
            font-size: 18px !important;
            font-weight: 500 !important;
            color: #1E2321 !important;
            background: transparent !important;
            padding: 5px !important;
        }

        #fc .fc-cart__item__total {
            text-align: right !important;
        }

        #fc .fc-cart__item__price__each {
            font-family: 'EB Garamond', serif !important;
            font-size: 14px !important;
            color: rgba(129, 127, 117, 0.8) !important;
            margin: 0 0 8px 0 !important;
        }

        #fc .fc-cart__item__total p {
            font-family: 'EB Garamond', serif !important;
            font-size: 18px !important;
            font-weight: 500 !important;
            color: #1E2321 !important;
            margin: 0 !important;
        }

        /* Hide single item price when quantity is 1 */
        #fc .fc-cart__item[data-quantity="1"] .fc-cart__item__price__each {
            display: none !important;
        }

        /* Tax Section */
        #fc .fc-address-entry h4 {
            font-family: 'EB Garamond', serif !important;
            font-size: 20px !important;
            color: #1E2321 !important;
            margin-bottom: 15px !important;
        }

        #fc .fc-form-control {
            border: 1px solid rgba(0, 0, 0, 0.5) !important;
            border-radius: 5px !important;
            padding: 10px 5px !important;
            font-family: 'EB Garamond', serif !important;
            font-size: 16px !important;
            color: #1E2321 !important;
            background: transparent !important;
        }

        /* Order Summary */
        #fc .fc-transaction__header {
            font-family: 'EB Garamond', serif !important;
            font-size: 30px !important;
            color: #1E2321 !important;
            margin-bottom: 10px !important;
        }

        #fc .fc-subtotal__label,
        #fc .fc-subtotal__value {
            font-family: 'EB Garamond', serif !important;
            font-size: 18px !important;
            color: #1E2321 !important;
        }

        /* Checkout Button */
        #fc .fc-action--checkout--button {
            background: #6B8E5A !important;
            color: white !important;
            font-family: 'EB Garamond', serif !important;
            font-size: 18px !important;
            font-weight: 500 !important;
            border: none !important;
            border-radius: 8px !important;
            padding: 15px 25px !important;
            width: 100% !important;
            margin-top: 20px !important;
            text-decoration: none !important;
            display: block !important;
            text-align: center !important;
        }

        #fc .fc-action--checkout--button:hover {
            background: #5A7A4A !important;
        }
    </style>
</head>

<body data-fc-context='{"cart_is_fullpage":true}'>
    <!-- FoxyCart Container (Required ID) -->
    <div id="fc">
        
        <!-- FoxyCart Template Logic (Required Structure) -->
        {% set cart_is_fullpage = true %}
        <div class="fc-context--cart-fullpage" data-fc-container="cart">
            {% embed 'cart.inc.twig' %}
            {% endembed %}
        </div>
        
    </div>
    
    <!-- FoxyCart JavaScript Files (Required) -->
    {% for js_file_src in config.js_files %}
        <script src="{{ js_file_src }}"></script>
    {% endfor %}
    
    <!-- Custom JavaScript -->
    <script>
        var FC = FC || {};
        FC.onLoad = function() {
            // Custom behaviors after FoxyCart loads
            FC.client.on('ready.done', function() {
                console.log('Custom FoxyCart sidecart ready');
                
                // Add quantity data attributes for styling
                var cartItems = document.querySelectorAll('.fc-cart__item');
                cartItems.forEach(function(item) {
                    var quantityInput = item.querySelector('.fc-cart__item__quantity__input');
                    if (quantityInput) {
                        item.setAttribute('data-quantity', quantityInput.value);
                        
                        // Update attribute when quantity changes
                        quantityInput.addEventListener('change', function() {
                            item.setAttribute('data-quantity', this.value);
                        });
                    }
                });
            });
            
            // Handle cart updates
            FC.client.on('cart-update', function() {
                console.log('Cart updated');
                
                // Re-apply quantity data attributes after updates
                setTimeout(function() {
                    var cartItems = document.querySelectorAll('.fc-cart__item');
                    cartItems.forEach(function(item) {
                        var quantityInput = item.querySelector('.fc-cart__item__quantity__input');
                        if (quantityInput) {
                            item.setAttribute('data-quantity', quantityInput.value);
                        }
                    });
                }, 100);
            });
        };
    </script>
</body>
</html>
